---
title: "CRDS HO Data Reduction"
author: "`r CRDSutils::init()$user`"
date: "`r format(Sys.Date(), '%d %b %Y')`"
params:
  runDate:
    label: "Run Date (YYYY-MM-DD)"
    value: 2022-01-01
  instrument:
    label: "CRDS Instrument"
    value: hids2046
    input: select
    choices: [hids2046, hids2052, hids2053]
output:
  html_document: 
    df_print: paged
    number_sections: yes
    code_folding: show
editor_options:
  chunk_output_type: console
---

```{r load, include = FALSE}
library(CRDSutils)
```

```{r, echo = FALSE}
cat(paste("Instrument =", instrument))
cat(paste("Run Date =", runDate))
pv = packageVersion("CRDSutils")
cat(paste("CRDSutils Version =", pv))
```

# Check Files

```{r check, echo = FALSE}
files = file_lookup(params$instrument, params$runDate)
files = check_files(files)
```

# Calibrate Data

```{r calibrate, echo = FALSE}
corrected = process_data(files)
```

# Review Data

```{r review, results = "alias", echo = FALSE}
library(knitr)
rd = review_data(corrected)
kable(rd$qa, caption = "QA Results")
kable(rd$data, caption = "Data Summary")
```

```{r write, include=FALSE}
#db(corrected, analyst)
excel(files, corrected)
```
